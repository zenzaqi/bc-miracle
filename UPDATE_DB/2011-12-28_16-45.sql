CREATE OR REPLACE VIEW  `vu_sum_jual_tunai` AS select (case `jc`.`jtunai_transaksi` when 'jual_produk' then `m1`.`jproduk_tanggal` when 'jual_rawat' then `m2`.`jrawat_tanggal` when 'jual_paket' then `m3`.`jpaket_tanggal` when 'jual_kwitansi' then `m4`.`kwitansi_tanggal` when 'jual_lunas' then `m5`.`fpiutang_tanggal` end) AS `tgl_transaksi`,`jc`.`jtunai_transaksi` AS `jtunai_transaksi`,`jc`.`jtunai_ref` AS `jtunai_ref`,`jc`.`jtunai_stat_dok` AS `jtunai_stat_dok`,sum(`jc`.`jtunai_nilai`) AS `jtunai_nilai` from (((((`jual_tunai` `jc` left join `master_jual_produk` `m1` on(((`m1`.`jproduk_nobukti` = `jc`.`jtunai_ref`) and (`jc`.`jtunai_transaksi` = 'jual_produk')))) left join `master_jual_rawat` `m2` on(((`m2`.`jrawat_nobukti` = `jc`.`jtunai_ref`) and (`jc`.`jtunai_transaksi` = 'jual_rawat')))) left join `master_jual_paket` `m3` on(((`m3`.`jpaket_nobukti` = `jc`.`jtunai_ref`) and (`jc`.`jtunai_transaksi` = 'jual_paket')))) left join `cetak_kwitansi` `m4` on(((`m4`.`kwitansi_no` = `jc`.`jtunai_ref`) and (`jc`.`jtunai_transaksi` = 'jual_kwitansi')))) left join `master_faktur_lunas_piutang` `m5` on(((`m5`.`fpiutang_nobukti` = `jc`.`jtunai_ref`) and (`jc`.`jtunai_transaksi` = 'jual_lunas')))) group by (case `jc`.`jtunai_transaksi` when 'jual_produk' then `m1`.`jproduk_tanggal` when 'jual_rawat' then `m2`.`jrawat_tanggal` when 'jual_paket' then `m3`.`jpaket_tanggal` when 'jual_kwitansi' then `m4`.`kwitansi_tanggal` end),`jc`.`jtunai_transaksi`,`jc`.`jtunai_ref`,`jc`.`jtunai_stat_dok`;
