ALTER TABLE `master_jual_produk` ADD `jproduk_totalbiaya` DOUBLE NOT NULL DEFAULT '0' AFTER `jproduk_bayar` ;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY INVOKER VIEW `vu_jproduk` AS select `master_jual_produk`.`jproduk_id` AS `jproduk_id`,`master_jual_produk`.`jproduk_nobukti` AS `jproduk_nobukti`,`customer`.`cust_nama` AS `cust_nama`,`customer`.`cust_no` AS `cust_no`,`customer`.`cust_member` AS `cust_member`,`master_jual_produk`.`jproduk_cust` AS `jproduk_cust`,`master_jual_produk`.`jproduk_tanggal` AS `jproduk_tanggal`,`master_jual_produk`.`jproduk_diskon` AS `jproduk_diskon`,`master_jual_produk`.`jproduk_cashback` AS `jproduk_cashback`,`master_jual_produk`.`jproduk_cara` AS `jproduk_cara`,`master_jual_produk`.`jproduk_cara2` AS `jproduk_cara2`,`master_jual_produk`.`jproduk_cara3` AS `jproduk_cara3`,`master_jual_produk`.`jproduk_bayar` AS `jproduk_bayar`,if(((`master_jual_produk`.`jproduk_totalbiaya` <> 0) or (`master_jual_produk`.`jproduk_totalbiaya` <> 'null')),`master_jual_produk`.`jproduk_totalbiaya`,(((sum(`detail_jual_produk`.`dproduk_harga`) * ((100 - `detail_jual_produk`.`dproduk_diskon`) / 100)) * ((100 - `master_jual_produk`.`jproduk_diskon`) / 100)) - `master_jual_produk`.`jproduk_cashback`)) AS `jproduk_totalbiaya`,`master_jual_produk`.`jproduk_keterangan` AS `jproduk_keterangan`,`master_jual_produk`.`jproduk_creator` AS `jproduk_creator`,`master_jual_produk`.`jproduk_date_create` AS `jproduk_date_create`,`master_jual_produk`.`jproduk_update` AS `jproduk_update`,`master_jual_produk`.`jproduk_date_update` AS `jproduk_date_update`,`master_jual_produk`.`jproduk_revised` AS `jproduk_revised` from ((((((`master_jual_produk` left join `customer` on((`master_jual_produk`.`jproduk_cust` = `customer`.`cust_id`))) left join `jual_transfer` on((`master_jual_produk`.`jproduk_nobukti` = `jual_transfer`.`jtransfer_ref`))) left join `jual_kwitansi` on((`master_jual_produk`.`jproduk_nobukti` = `jual_kwitansi`.`jkwitansi_ref`))) left join `jual_card` on((`master_jual_produk`.`jproduk_nobukti` = `jual_card`.`jcard_ref`))) left join `jual_cek` on((`master_jual_produk`.`jproduk_nobukti` = `jual_cek`.`jcek_ref`))) left join `detail_jual_produk` on((`detail_jual_produk`.`dproduk_master` = `master_jual_produk`.`jproduk_id`))) group by `master_jual_produk`.`jproduk_id`;