CREATE OR REPLACE VIEW `miracledb`.`vu_detail_terima_order` AS SELECT `mo`.`order_id` AS `master`,`do`.`dorder_produk` AS `produk`,`do`.`dorder_satuan` AS `satuan`,`do`.`dorder_jumlah` AS `jumlah_order`,`dt`.`dterima_jumlah` AS `jumlah_terima`,(`do`.`dorder_jumlah` - `dt`.`dterima_jumlah`) AS `jumlah_sisa` FROM (((`miracledb`.`detail_order_beli` `do` JOIN `miracledb`.`master_order_beli` `mo`) JOIN `miracledb`.`detail_terima_beli` `dt`) JOIN `miracledb`.`master_terima_beli` `mt`) WHERE ((`do`.`dorder_master` = `mo`.`order_id`) AND (`dt`.`dterima_master` = `mt`.`terima_id`) AND (`mt`.`terima_order` = `mo`.`order_id`) AND (`do`.`dorder_produk` = `dt`.`dterima_produk`) AND (`do`.`dorder_satuan` = `dt`.`dterima_satuan`)) UNION SELECT `mo`.`order_id` AS `master`,`do`.`dorder_produk` AS `produk`,`do`.`dorder_satuan` AS `satuan`,`do`.`dorder_jumlah` AS `jumlah_order`,0 AS `jumlah_terima`,`do`.`dorder_jumlah` AS `jumlah_sisa` FROM (`miracledb`.`detail_order_beli` `do` JOIN `miracledb`.`master_order_beli` `mo`) WHERE ((`do`.`dorder_master` = `mo`.`order_id`) AND (NOT((`do`.`dorder_produk`,`do`.`dorder_satuan`) IN (SELECT `dt`.`dterima_produk` AS `dterima_produk`,`dt`.`dterima_satuan` AS `dterima_satuan` FROM (`miracledb`.`detail_terima_beli` `dt` JOIN `miracledb`.`master_terima_beli` `mt`) WHERE ((`mt`.`terima_id` = `dt`.`dterima_master`) AND (`mt`.`terima_order` = `mo`.`order_id`)))))) UNION SELECT `mt`.`terima_id` AS `master`,`dt`.`dterima_produk` AS `produk`,`dt`.`dterima_satuan` AS `satuan`,0 AS `jumlah_order`,`dt`.`dterima_jumlah` AS `jumlah_terima`,-(`dt`.`dterima_jumlah`) AS `jumlah_sisa` FROM (`miracledb`.`detail_terima_beli` `dt` JOIN `miracledb`.`master_terima_beli` `mt`) WHERE ((`mt`.`terima_id` = `dt`.`dterima_master`) AND (NOT((`dt`.`dterima_produk`,`dt`.`dterima_satuan`) IN (SELECT `do`.`dorder_produk` AS `dorder_produk`,`do`.`dorder_satuan` AS `dorder_satuan` FROM (`miracledb`.`master_order_beli` `mo` JOIN `miracledb`.`detail_order_beli` `do`) WHERE ((`mo`.`order_id` = `do`.`dorder_master`) AND (`mo`.`order_id` = `mt`.`terima_order`))))));